namespace Bars.Gkh.Overhaul.Tat.PriorityParams.Impl
{
    using Entities;

    public class YearExploitationPriorityParam : IPriorityParams
    {
        public string Id 
        {
            get { return "YearExploitation"; }
        }

        public string Name
        {
            get { return "Эксплуатация МКД (год)"; }
        }

        public TypeParam TypeParam 
        {
            get { return TypeParam.Quant; }
        }

        public object GetValue(RealityObjectStructuralElementInProgrammStage3 obj)
        {
            return obj.Year -
                   (obj.RealityObject.DateCommissioning.HasValue
                       ? obj.RealityObject.DateCommissioning.Value.Year
                       : obj.RealityObject.BuildYear.HasValue
                           ? obj.RealityObject.BuildYear.Value
                           : 0);
        }
    }
}